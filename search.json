---
layout: null
permalink: /search.json
---

[
  {% comment %}
  Build a flat list of pages + posts (skip those that set `search_exclude:true`)
  {% endcomment %}
  {% assign pages = site.pages | where_exp: "p", "p.search_exclude != true" %}
  {% assign posts = site.posts | where_exp: "p", "p.search_exclude != true" %}
  {% assign all = pages | concat: posts %}
  {% for doc in all %}
  {
    "title": {{ doc.title | default: doc.name | jsonify }},
    "url": {{ doc.url | relative_url | jsonify }},
    "date": {{ doc.date | date_to_string | jsonify }},
    "type": {{ doc.collection | default: "page" | jsonify }},
    "content": {{ doc.content | strip_html | normalize_whitespace | jsonify }}
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
